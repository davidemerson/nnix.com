<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{{ page.title }} – nnix.com</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- use the site’s main stylesheet -->
  <link rel="stylesheet" href="/style.css">
<style>
  /* layout + header */

.oracle-header {
  margin-bottom: 1.5rem;
}

.oracle-header h1 {
  margin: 0 0 0.25rem;
  text-transform: lowercase;
}

.oracle-header p {
  margin: 0;
}

.oracle-controls {
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  gap: 1ch;
  margin: 2ch 0;
}

.oracle-controls button {
  padding: 0.4rem 0.9rem;
  border-radius: 999px;
  border: 1px solid #000;
  background: transparent;
  font-family: var(--font-family-medium);
  font-size: 0.95em;
  text-transform: lowercase;
  cursor: pointer;
}

.oracle-controls button:hover,
.oracle-controls button:focus-visible {
  background-color: #000;
  color: #f2f2f2;
}

.oracle-controls button:disabled {
  opacity: 0.5;
  cursor: default;
  background: transparent;
  color: inherit;
}

#castStatus {
  font-family: var(--font-family-mono);
  font-size: 0.85em;
}

.oracle-columns {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2ch;
  margin-bottom: 3ch;
}

@media (max-width: 800px) {
  .oracle-columns {
    grid-template-columns: 1fr;
  }
}

/* boxes */

.hex-box {
  border-radius: var(--border-radius);
  background-color: var(--secondary-bg-color);
  padding: 1.5ch;
}

.hex-box h2 {
  margin-top: 0;
  margin-bottom: 0.5rem;
  text-transform: lowercase;
}

.oracle-label {
  margin: 0 0 1rem;
  font-size: 0.95em;
}

/* hexagram lines */

.hex-lines {
  display: flex;
  flex-direction: column-reverse; /* show line 6 at top */
  gap: 0.25rem;
  font-family: var(--font-family-mono);
  margin-bottom: 1rem;
}

.line {
  display: grid;
  grid-template-columns: 3ch minmax(7ch, 1fr) auto;
  align-items: baseline;
  column-gap: 1ch;
  font-size: 0.85em;
}

.line-num {
  text-align: right;
  color: #777;
  font-family: var(--font-family-mono);
}

.line-glyph {
  letter-spacing: 0.35ch;
  text-align: center;
  font-family: var(--font-family-mono);
}

.line-kind {
  white-space: nowrap;
  color: #444;
  font-family: var(--font-family-medium);
  font-size: 0.85em;
  text-transform: lowercase;
}

/* visual emphasis for changing lines */

.line.changing .line-glyph {
  text-decoration: underline;
}

.line.changing .line-kind {
  font-weight: 600; /* heavier, but still in same font */
}

/* metadata + notes */

.oracle-meta {
  font-size: 0.9em;
  margin: 0.4rem 0;
}

.oracle-meta label {
  display: block;
  font-family: var(--font-family-mono);
  font-size: 0.8em;
  color: #666;
  margin-bottom: 0.1rem;
}

.oracle-meta code {
  display: inline-block;
  padding: 0.1rem 0.4rem;
  border-radius: 999px;
  background-color: #f2f2f2;
}

.oracle-symbol {
  font-size: 1.4em;
  line-height: 1;
}

.oracle-notes h2 {
  text-transform: lowercase;
}

.oracle-notes p {
  margin-top: 0;
}
</style>
</head>
<body>
<main>
  <header class="oracle-header">
    <h1>I Ching hexagram oracle</h1>
    <p class="subtle-mono">
      an accurate hexagram cast using crypto-randomness; use the result with whatever text you trust
    </p>
  </header>

  <section class="oracle-controls">
    <button id="castBtn">cast hexagram</button>
    <span id="castStatus" class="subtle-mono">awaiting question…</span>
  </section>

  <section class="oracle-columns">
    <section class="hex-box">
      <h2>primary hexagram</h2>
      <p id="primaryLabel" class="oracle-label">—</p>

      <div class="hex-lines" id="primaryLines"></div>

      <p class="oracle-meta">
        <label>binary (bottom → top)</label>
        <code id="primaryBinary">———</code>
      </p>
      <p class="oracle-meta">
        <label>symbol</label>
        <span id="primarySymbol" class="oracle-symbol">–</span>
      </p>
    </section>

    <section class="hex-box">
      <h2>relating hexagram</h2>
      <p id="relatingLabel" class="oracle-label">
        no changing lines → same as primary
      </p>

      <div class="hex-lines" id="relatingLines"></div>

      <p class="oracle-meta">
        <label>binary (bottom → top)</label>
        <code id="relatingBinary">———</code>
      </p>
      <p class="oracle-meta">
        <label>changing lines</label>
        <span id="changingLines">—</span>
      </p>
      <p class="oracle-meta">
        <label>note</label>
        <span>line numbers are counted from the bottom (1) to the top (6).</span>
      </p>
      <p class="oracle-meta">
        <label>symbol</label>
        <span id="relatingSymbol" class="oracle-symbol">–</span>
      </p>
    </section>
  </section>

  <section class="oracle-notes">
    <h2>method</h2>
    <p>
      this uses a four-coin method that matches the odds of the classical yarrow-stalk oracle, driven by
      <code>window.crypto.getRandomValues</code> in the browser.
    </p>
    <ul class="ing">
      <li>each line is from four independent “coins”</li>
      <li>tails = 2, heads = 3, summed (8–11 are valid)</li>
      <li>mapping:</li>
      <ul class="ing">
        <li>6 → old yin (broken, changing to yang)</li>
        <li>7 → young yang (solid, stays yang)</li>
        <li>8 → young yin (broken, stays yin)</li>
        <li>9 → old yang (solid, changing to yin)</li>
      </ul>
    </ul>
    <p>
      primary and relating hexagrams are looked up via the King Wen sequence using a binary pattern
      (bottom → top, 1 = yang, 0 = yin). note the line numbers shown, then go to whatever I Ching
      translation you actually trust.
    </p>
  </section>
</main>

<script src="{{ get_url(path='oracle.js') }}"></script>
</body>
</html>
