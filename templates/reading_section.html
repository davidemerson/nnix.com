{% extends "base.html" %}

{% block content %}
<div><a href=".."><<<</a></div>
<h1>{{ section.title }}</h1>

{{ section.content | safe }}
{% set pages = section.pages %}

<h2>currently reading</h2>
<ul>
{% for page in pages %}
  {% if page.taxonomies.readstate and page.taxonomies.readstate[0] == "reading" %}
  <li>
    {{ page.taxonomies.authorname[0] | default(value="") }}.
    ({{ page.taxonomies.pubyear[0] | default(value="") }}).
    <a href="{{ page.permalink | safe }}"><i>{{ page.title }}</i></a>.
    <br>
    {% if page.taxonomies.rating and page.taxonomies.rating | length > 0 %}
    <sub>rated {{ page.taxonomies.rating[0] }}/5</sub>
    <br>
    {% else %}
    <sub>unrated</sub>
    <br>
    {% endif %}
    {% if page.taxonomies.recommender and page.taxonomies.recommender | length > 0 %}
    <sub>recommended by {{ page.taxonomies.recommender[0] }}</sub>
    <br>
    {% endif %}
  </li>
  {% endif %}
{% endfor %}
</ul>

<h2>recently read</h2>
{% set sorted_pages = pages | sort(attribute="date", reverse=true) %}
<ul>
{% set counter = 0 %}
{% for page in sorted_pages %}
  {% if counter < 5 %}
    <li>
      {{ page.taxonomies.authorname[0] | default(value="") }}.
      ({{ page.taxonomies.pubyear[0] | default(value="") }}).
      <a href="{{ page.permalink | safe }}"><i>{{ page.title }}</i></a>.
      <br>
      {% if page.taxonomies.rating and page.taxonomies.rating | length > 0 %}
      <sub>rated {{ page.taxonomies.rating[0] }}/5</sub>
      <br>
      {% else %}
      <sub>unrated</sub>
      <br>
      {% endif %}
      {% if page.taxonomies.recommender and page.taxonomies.recommender | length > 0 %}
      <sub>recommended by {{ page.taxonomies.recommender[0] }}</sub>
      <br>
      {% endif %}
    </li>
    {% set counter = counter + 1 %}
  {% else %}
    {% break %}
  {% endif %}
{% endfor %}
</ul>

<h2>top rated</h2>
<ul>
{% for page in pages %}
  {% if page.taxonomies.rating and page.taxonomies.rating[0] == 5 %}
  <li>
    {{ page.taxonomies.authorname[0] | default(value="") }}.
    ({{ page.taxonomies.pubyear[0] | default(value="") }}).
    <a href="{{ page.permalink | safe }}"><i>{{ page.title }}</i></a>.
    <br>
    <sub>rated {{ page.taxonomies.rating[0] }}/5</sub>
    <br>
    {% if page.taxonomies.recommender and page.taxonomies.recommender | length > 0 %}
    <sub>recommended by {{ page.taxonomies.recommender[0] }}</sub>
    <br>
    {% else %}
    <sub> </sub>
    <br>
    {% endif %}
  </li>
  {% endif %}
{% endfor %}
</ul>

<h2>queued, unread</h2>
<ul>
{% for page in pages %}
  {% if page.taxonomies.readstate and page.taxonomies.readstate[0] == "queue" %}
  <li>
    {{ page.taxonomies.authorname[0] | default(value="") }}.
    ({{ page.taxonomies.pubyear[0] | default(value="") }}).
    <a href="{{ page.permalink | safe }}"><i>{{ page.title }}</i></a>.
    <br>
    {% if page.taxonomies.rating and page.taxonomies.rating | length > 0 %}
    <sub>rated {{ page.taxonomies.rating[0] }}/5</sub>
    {% else %}
    <sub>unrated</sub>
    <br>
    {% endif %}
    {% if page.taxonomies.recommender and page.taxonomies.recommender | length > 0 %}
    <sub>recommended by {{ page.taxonomies.recommender[0] }}</sub>
    <br>
    {% endif %}
  </li>
  {% endif %}
{% endfor %}
</ul>

{% endblock %}